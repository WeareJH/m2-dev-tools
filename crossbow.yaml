tasks:
  build-all:
    description: |
      Build all shells.
    tasks:
      - clean
      - chrome
      - inject
      - bg
      - build-chrome
      - tasks/manifest

  start:
    description: |
      Run the application in a regular Browser window with sample data
    tasks:
      - app-watch

  build-chrome:
    description: |
      Build the chrome Shell
    adaptor: npm
    command: >
      parcel build chrome.html --out-dir shells/chrome/dist --no-cache

  app-watch:
    description: Run the extension in regular browser window
    adaptor: npm
    command: >
      parcel plain.html

  lc:
    description: |
      Open a fresh instance of Chrome - this is a convience for easier debugging.
    adaptor: sh
    command: >
      /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome
      --auto-open-devtools-for-tabs
      https://gg.m2

  chrome:
    adaptor: npm
    command: >
      tsc src/chrome/{inject.ts,main.ts,background.ts}  --outdir shells/chrome/build
      --lib ES2015,DOM

  inject:
    adaptor: npm
    command: >
      browserify shells/chrome/build/chrome/inject.js
      > shells/chrome/build/inject.browser.js

  bg:
    adaptor: npm
    command: >
      browserify shells/chrome/build/chrome/background.js
      > shells/chrome/build/background.browser.js

  chrome-watch:
    adaptor: npm
    command: >
      tsc src/chrome/{inject.ts,main.ts,background.ts} -w --outdir shells/chrome/build
      --lib ES2015,DOM

  clean:
    - '@sh rm -rf shells/chrome/dist/**'
    - '@sh rm -rf shells/chrome/build/**'
